spryk: template
description: "Adds a new *resourceType*By*relationshipParameter*ResourceRelationshipPlugin to the Glue application."
mode: both

arguments:
  module:
    inherit: true

  organization:
    inherit: true
    default: Spryker

  template:
    value: Glue/Plugin/GlueApplication/GlueResourceRelationshipPlugin.php.twig

  resourceType:
    inherit: true

  relationshipParameter:
    inherit: true

  pluginClassName:
    value: "{{ resourceType | dashToCamelCase | singularize }}By{{ relationshipParameter | dashToCamelCase }}ResourceRelationshipPlugin"

  expanderClassName:
    value: "{{ resourceType | dashToCamelCase | singularize }}By{{ relationshipParameter | dashToCamelCase }}Expander"

  targetFilename:
    value: "{{ pluginClassName }}.php"

  targetPath:
    value: "{{ module }}/src/{{ organization }}/Glue/{{ module }}/Plugin/GlueApplication/"

preSpryks:
  - AddModule
  - AddSharedRestAttributesTransfer:
      arguments:
        name:
          value: "{{ resourceType | dashToCamelCase }}"
          callback:
            - EnsureRestAttributesTransferAffix

  - AddGlueConfigConstant:
      arguments:
        name:
          value: "RESOURCE_{{ resourceType | dashToUnderscore | upper }}"
        value:
          value:  "{{ resourceType | dasherize }}"
        visibility:
          value:  "public"

  - AddGlueFactoryMethod:
      arguments:
        subDirectory:
          value: "Expander"
        className:
          value: "{{ expanderClassName }}"

  - AddGlueProcessorModelMethod:
      arguments:
        subDirectory:
          value: "Expander"
        modelSuffix:
          value: "Expander"
        method:
          value: "addResourceRelationships"
        input:
          value: "array $resources, \\Spryker\\Glue\\GlueApplication\\Rest\\Request\\Data\\RestRequestInterface $restRequest"
        output:
          value: "array"
